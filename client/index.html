<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AR Hunter - Original Pro</title>
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <style>
        body { margin: 0; overflow: hidden; }
        /* প্রফেশনাল রান বাটন */
        #run-btn { 
            position: fixed; left: 40px; bottom: 120px; width: 80px; height: 80px; 
            background: rgba(255,255,255,0.3) url('https://img.icons8.com/ios-filled/50/ffffff/running.png') no-repeat center;
            background-size: 50%; border: 3px solid white; border-radius: 50%; z-index: 100;
        }
        /* ফায়ার বাটন */
        #fire-btn { 
            position: fixed; right: 40px; bottom: 40px; width: 120px; height: 120px; 
            background: radial-gradient(circle, #ff4444, #990000); 
            border: 5px solid rgba(255,255,255,0.8); border-radius: 50%; z-index: 100;
        }
    </style>
</head>
<body>
    <div id="run-btn"></div>
    <div id="fire-btn"></div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
        <a-entity id="rig" position="0 2 12"> 
            <a-camera look-controls wasd-controls-enabled="false"></a-camera>
            
            <a-entity id="player" position="0 -1.6 -4.5" scale="1 1 1">
                <a-cylinder id="leg" color="#111" height="1.6" radius="0.25"></a-cylinder> <a-box color="#3b5998" width="0.75" height="1" depth="0.4" position="0 0.7 0"></a-box> <a-sphere color="#ffe0bd" radius="0.3" position="0 1.5 0"></a-sphere> </a-entity>
        </a-entity>
        <a-box id="monster" position="0 1.5 -15" color="red" scale="3 3 3"></a-box>
    </a-scene>

    <script>
        const socket = io();
        let running = false;
        const rig = document.getElementById('rig');
        const player = document.getElementById('player');

        document.getElementById('run-btn').ontouchstart = () => running = true;
        document.getElementById('run-btn').ontouchend = () => {
            running = false;
            player.setAttribute('rotation', '0 0 0'); // থামালে সোজা হবে
        };

        setInterval(() => {
            if(running) {
                let pos = rig.getAttribute('position');
                pos.z -= 0.2; // সামনের দিকে দৌড়ানো
                rig.setAttribute('position', pos);
                
                // দৌড়ানোর সময় ক্যারেক্টারটি ডানে-বামে একটু দুলবে (অরিজিনাল লুক)
                let wobble = Math.sin(Date.now() * 0.01) * 8;
                player.setAttribute('rotation', `0 0 ${wobble}`);
                
                socket.emit('move', pos);
            }
        }, 50);
    </script>
</body>
</html>
