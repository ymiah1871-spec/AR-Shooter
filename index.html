<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>FF AR - Ultimate Edition</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body { margin: 0; overflow: hidden; font-family: 'Segoe UI', sans-serif; user-select: none; -webkit-user-select: none; }
        
        /* ‡¶≤‡¶¨‡¶ø ‡¶è‡¶¨‡¶Ç ‡¶Æ‡ßá‡¶®‡ßÅ */
        #main-lobby {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.8)), url('https://images.wallpapersden.com/image/download/garena-free-fire-2021_bWlpZ2mUmZqaraWkpJRmbmdlrWlnZ2U.jpg');
            background-size: cover; z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }

        .btn {
            padding: 15px 40px; margin: 10px; border: none; border-radius: 5px;
            font-size: 20px; font-weight: bold; cursor: pointer; transition: 0.3s;
        }
        .start-btn { background: #ffcc00; box-shadow: 0 0 20px #ffcc00; }
        .invite-btn { background: #007bff; color: white; }

        /* ‡¶ó‡ßá‡¶Æ ‡¶á‡¶â‡¶Ü‡¶á */
        #game-ui { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; display: none; z-index: 100; }
        
        .control-btn {
            position: absolute; pointer-events: auto; width: 70px; height: 70px;
            border-radius: 50%; border: 3px solid white; color: white;
            display: flex; align-items: center; justify-content: center; font-weight: bold;
        }
        .fire-btn { right: 10%; bottom: 15%; background: rgba(255,0,0,0.6); display: none; }
        .mic-btn { left: 10%; top: 10%; background: rgba(0,0,0,0.5); }
        .active-mic { background: #00ff00; box-shadow: 0 0 15px #00ff00; }
        .alok-btn { left: 50%; bottom: 15%; transform: translateX(-50%); background: rgba(0,200,255,0.7); }

        #loot-alert {
            position: fixed; top: 20%; width: 100%; text-align: center;
            color: gold; font-size: 22px; font-weight: bold; display: none;
        }
    </style>
</head>

<body>

    <div id="main-lobby">
        <h1 style="color: gold; text-shadow: 0 0 10px black; font-size: 40px;">SQUAD LOBBY</h1>
        <div style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 10px; margin-bottom: 20px;">
            <p style="color: white;">Team: <span id="player-count">1/4</span> Online</p>
            <div style="display: flex; gap: 10px;">
                <div style="width: 50px; height: 50px; background: gold; border-radius: 5px; display: flex; align-items: center; justify-content: center;">üë§</div>
                <div style="width: 50px; height: 50px; border: 2px dashed white; border-radius: 5px;"></div>
                <div style="width: 50px; height: 50px; border: 2px dashed white; border-radius: 5px;"></div>
            </div>
        </div>
        <button class="btn invite-btn" onclick="inviteFriends()">INVITE FRIENDS</button>
        <button class="btn start-btn" onclick="startGame()">START MATCH</button>
    </div>

    <div id="game-ui">
        <div id="loot-alert">GO NEAR THE GUN TO PICK UP!</div>
        <div class="control-btn mic-btn" id="mic-toggle" onclick="toggleVoice()">üé§</div>
        <div class="control-btn fire-btn" id="f-btn" onclick="fire()">üî•</div>
        <div class="control-btn alok-btn" onclick="alokAbility()">DJ</div>
        <div style="position: absolute; top: 20px; right: 20px; color: white; background: rgba(0,0,0,0.5); padding: 5px 15px; border-radius: 20px;">
            HP: <span id="hp">200</span>
        </div>
    </div>

    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;" vr-mode-ui="enabled: false">
        <a-assets>
            <a-asset-item id="alok" src="https://vazxmixjsiawhamofees.supabase.co/storage/v1/object/public/models/ready-player-me/model.gltf"></a-asset-item>
            <a-asset-item id="m16" src="https://vazxmixjsiawhamofees.supabase.co/storage/v1/object/public/models/m16/model.gltf"></a-asset-item>
        </a-assets>

        <a-entity camera>
            <a-entity id="my-gun" gltf-model="#m16" position="0.3 -0.4 -0.6" rotation="0 180 0" scale="0.12 0.12 0.12" visible="false"></a-entity>
            <a-ring id="h-ring" color="cyan" rotation="-90 0 0" radius-inner="1.2" radius-outer="1.4" position="0 -1.5 0" visible="false"></a-ring>
            <a-cursor color="yellow"></a-cursor>
        </a-entity>

        <a-entity id="loot-gun" gltf-model="#m16" position="1 -1 -4" rotation="0 45 0" scale="0.1 0.1 0.1" onclick="pickup()">
            <a-text value="PICK UP M16" align="center" position="0 1.5 0" color="gold" scale="2 2 2"></a-text>
        </a-entity>

        <a-entity id="lobby-char" gltf-model="#alok" position="0 -1 -3" scale="1.5 1.5 1.5"></a-entity>
    </a-scene>

    <script>
        let health = 200;
        let isArmed = false;
        let micOn = false;

        function inviteFriends() {
            const url = window.location.href;
            alert("‡¶¨‡¶®‡ßç‡¶ß‡ßÅ‡¶¶‡ßá‡¶∞ ‡¶°‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶á ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï‡¶ü‡¶ø ‡¶™‡¶æ‡¶†‡¶æ‡¶®:\n" + url);
        }

        function startGame() {
            document.getElementById('main-lobby').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';
            document.getElementById('loot-alert').style.display = 'block';
            setTimeout(() => { document.getElementById('loot-alert').style.display = 'none'; }, 4000);
        }

        async function toggleVoice() {
            const btn = document.getElementById('mic-toggle');
            if (!micOn) {
                try {
                    await navigator.mediaDevices.getUserMedia({ audio: true });
                    micOn = true;
                    btn.classList.add('active-mic');
                } catch(e) { alert("Mic permission denied!"); }
            } else {
                micOn = false;
                btn.classList.remove('active-mic');
            }
        }

        function pickup() {
            isArmed = true;
            document.getElementById('loot-gun').setAttribute('visible', 'false');
            document.getElementById('my-gun').setAttribute('visible', 'true');
            document.getElementById('f-btn').style.display = 'flex';
            alert("M16 Equipped!");
        }

        function alokAbility() {
            const ring = document.getElementById('h-ring');
            ring.setAttribute('visible', 'true');
            let timer = setInterval(() => {
                if(health < 200) { health += 2; document.getElementById('hp').innerText = health; }
            }, 1000);
            setTimeout(() => { ring.setAttribute('visible', 'false'); clearInterval(timer); }, 6000);
        }

        function fire() {
            const g = document.getElementById('my-gun');
            g.setAttribute('animation', 'property: position; to: 0.3 -0.4 -0.55; dur: 50; dir: alternate; loop: 1');
        }
    </script>
</body>
</html>
